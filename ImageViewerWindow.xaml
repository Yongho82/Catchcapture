<Window x:Class="CatchCapture.ImageViewerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="Image Viewer" Height="750" Width="1100"
        WindowStyle="None" AllowsTransparency="True" Background="Transparent"
        WindowStartupLocation="CenterScreen" ShowInTaskbar="True">

    <Window.Resources>
        <Style x:Key="IconButton" TargetType="Button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="8"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border" Background="{TemplateBinding Background}" CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#2FFFFFFF"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#3FFFFFFF"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <WindowChrome.WindowChrome>
        <WindowChrome CaptionHeight="40" CornerRadius="0" GlassFrameThickness="0" ResizeBorderThickness="8" UseAeroCaptionButtons="False"/>
    </WindowChrome.WindowChrome>

    <Border Background="{DynamicResource ThemeBackground}" BorderBrush="{DynamicResource ThemeBorder}" BorderThickness="1" CornerRadius="12" ClipToBounds="True" Margin="10">
        <Grid x:Name="MainGrid">
            <Grid.RowDefinitions>
                <RowDefinition Height="40"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Top Header -->
            <Border Grid.Row="0" Background="{DynamicResource ThemeTitleBackground}" CornerRadius="12,12,0,0"/>
            <Grid Grid.Row="0" Margin="20,0">
                <!-- Left: Logo & App Title -->
                <StackPanel Orientation="Horizontal" VerticalAlignment="Center" WindowChrome.IsHitTestVisibleInChrome="True">
                    <Image Source="icons/catcha.png" Width="24" Height="24" Margin="0,0,10,0" RenderOptions.BitmapScalingMode="HighQuality"/>
                    <TextBlock x:Name="TxtAppTitle" Text="캐치캡처-뷰어" Foreground="{DynamicResource ThemeTitleForeground}" Opacity="0.8" FontSize="13" VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Center: File Name -->
                <TextBlock x:Name="TxtFileName" Foreground="{DynamicResource ThemeTitleForeground}" FontSize="13" FontWeight="Medium" 
                           HorizontalAlignment="Center" VerticalAlignment="Center" Text="Image Viewer" 
                           IsHitTestVisible="False"/>

                <!-- Right: Tools and Window Controls -->
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center" WindowChrome.IsHitTestVisibleInChrome="True">
                    <Button x:Name="BtnZoomReset" Style="{StaticResource IconButton}" Click="BtnZoomReset_Click" Margin="0,0,5,0" ToolTip="Reset Zoom (1:1)">
                        <Path Data="M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.43,13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14M12,10H7V9H12V10Z" Fill="{DynamicResource ThemeTitleForeground}" Width="18" Height="18" Stretch="Uniform"/>
                    </Button>
                    <Button x:Name="BtnPin" Style="{StaticResource IconButton}" Click="BtnPin_Click" Margin="0,0,5,0">
                        <Path Data="M16,12V4H17V2H7V4H8V12L6,14V16H11.2V22H12.8V16H18V14L16,12M14.2,14H9.8L10,12.2V4H14V12.2L14.2,14Z" Fill="{DynamicResource ThemeTitleForeground}" Width="16" Height="16" Stretch="Uniform"/>
                    </Button>
                    <Button x:Name="BtnCopy" Style="{StaticResource IconButton}" Click="BtnCopy_Click" Margin="0,0,5,0" ToolTip="Copy to Clipboard">
                        <Path Data="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" Fill="{DynamicResource ThemeTitleForeground}" Width="18" Height="18" Stretch="Uniform"/>
                    </Button>
                    <Button x:Name="BtnSaveAs" Style="{StaticResource IconButton}" Click="BtnSaveAs_Click" Margin="0,0,10,0" ToolTip="Save Image As...">
                        <Path Data="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z" Fill="{DynamicResource ThemeTitleForeground}" Width="18" Height="18" Stretch="Uniform"/>
                    </Button>
                    
                    <Border Width="1" Height="24" Background="{DynamicResource ThemeTitleForeground}" Opacity="0.3" Margin="5,0,15,0"/>
                    
                    <Button Style="{StaticResource IconButton}" Click="BtnMinimize_Click" Width="36" Height="32">
                        <Path Data="M20,14H4V10H20V14Z" Fill="{DynamicResource ThemeTitleForeground}" Width="14" Height="14" Stretch="Uniform"/>
                    </Button>
                    <Button Style="{StaticResource IconButton}" Click="BtnMaximize_Click" Width="36" Height="32">
                        <Path x:Name="PathMaximize" Data="M4,4H20V20H4V4M6,8V18H18V8H6Z" Fill="{DynamicResource ThemeTitleForeground}" Width="14" Height="14" Stretch="Uniform"/>
                    </Button>
                    <Button Style="{StaticResource IconButton}" Click="BtnClose_Click" Width="36" Height="32">
                        <Path Data="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z" Fill="#FF6B6B" Width="16" Height="16" Stretch="Uniform"/>
                    </Button>
                </StackPanel>
            </Grid>

            <!-- Main Viewer Area -->
            <Grid Grid.Row="1" x:Name="ViewerGrid" ClipToBounds="True" Background="{DynamicResource CheckerboardBrush}"
                  MouseWheel="ViewerGrid_MouseWheel"
                  MouseLeftButtonDown="ViewerGrid_MouseLeftButtonDown"
                  MouseMove="ViewerGrid_MouseMove"
                  MouseLeftButtonUp="ViewerGrid_MouseLeftButtonUp">
                
                <Canvas x:Name="ViewCanvas">
                    <Image x:Name="ImgDisplay" Stretch="None" RenderOptions.BitmapScalingMode="HighQuality">
                        <Image.RenderTransform>
                            <TransformGroup>
                                <ScaleTransform x:Name="ImgScale"/>
                                <TranslateTransform x:Name="ImgTranslate"/>
                            </TransformGroup>
                        </Image.RenderTransform>
                    </Image>
                </Canvas>

                <!-- Zoom Level HUD -->
                <Border VerticalAlignment="Bottom" HorizontalAlignment="Center" Margin="0,0,0,30" 
                        Background="#99000000" CornerRadius="20" Padding="15,8" BorderBrush="#2FFFFFFF" BorderThickness="1">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock x:Name="TxtZoomLevel" Text="100%" Foreground="White" FontSize="13" FontWeight="SemiBold" VerticalAlignment="Center"/>
                        <TextBlock x:Name="TxtResolution" Text=" (1920 x 1080)" Foreground="#99FFFFFF" FontSize="11" Margin="8,0,0,0" VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Grid>
    </Border>
</Window>
